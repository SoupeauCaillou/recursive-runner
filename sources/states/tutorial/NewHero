#pragma once

struct NewHeroTutorialStep : public TutorialStep {
    void enter(LocalizeAPI* loc, SessionComponent* sc, TutorialEntities* entities) {
        TEXT_RENDERING(entities->text)->hide = true;
        TEXT_RENDERING(entities->text)->text = loc->text("new_hero", "This is the your new hero");

        RENDERING(entities->anim)->hide = false;
        TRANSFORM(entities->anim)->position = TRANSFORM(sc->currentRunner)->worldPosition +
            TRANSFORM(sc->currentRunner)->size * Vector2(-0.5, 1);
        TRANSFORM(entities->anim)->rotation = MathUtil::AngleFromVector(
             TRANSFORM(sc->currentRunner)->worldPosition - TRANSFORM(entities->anim)->position);
    }
    bool mustUpdateGame(SessionComponent* sc, TutorialEntities* entities) {
        if (sc->runners.size() == 1) {
            return true;
        } else if (TRANSFORM(sc->currentRunner)->position.X > 29) {
            RUNNER(sc->runners[0])->startTime = 0;
            return true;
        } else {
            TEXT_RENDERING(entities->text)->hide = false;
            ANIMATION(sc->currentRunner)->playbackSpeed = 0;
            return false;
        }
    }
    bool canExit(SessionComponent* sc, TutorialEntities* ) {
        return (ANIMATION(sc->currentRunner)->playbackSpeed == 0);
    }
    void exit(SessionComponent* sc, TutorialEntities*) {
        ANIMATION(sc->currentRunner)->playbackSpeed = 1.1;
    }
};
