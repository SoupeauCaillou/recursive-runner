#pragma once

#include <glm/gtx/vector_angle.hpp>

struct IntroduceHeroTutorialStep : public TutorialStep {
    void enter(LocalizeAPI* loc,  SessionComponent* sc, TutorialEntities* entities) {
        TEXT_RENDERING(entities->text)->show = false;
        TEXT_RENDERING(entities->text)->text = loc->text("this_is_you", "This is You");
        RENDERING(entities->anim)->show = true;
        TRANSFORM(entities->anim)->position = TRANSFORM(sc->currentRunner)->worldPosition +
            TRANSFORM(sc->currentRunner)->size * glm::vec2(0.5, 1);
        TRANSFORM(entities->anim)->rotation = 
            glm::angle(TRANSFORM(sc->currentRunner)->worldPosition, TRANSFORM(entities->anim)->position);
    }
    bool mustUpdateGame(SessionComponent* , TutorialEntities*) {
        return true;
    }
    bool canExit(SessionComponent* sc, TutorialEntities* entities) {
        if (TRANSFORM(sc->currentRunner)->position.x >= -23) {
            ANIMATION(sc->currentRunner)->playbackSpeed = 0;
            TEXT_RENDERING(entities->text)->show = true;
            return true;
        } else {
            return false;
        }
    }
    void exit(SessionComponent* sc, TutorialEntities*) {
        ANIMATION(sc->currentRunner)->playbackSpeed = 1.1;
    }
};
